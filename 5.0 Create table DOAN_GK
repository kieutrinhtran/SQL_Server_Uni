CREATE DATABASE DO_AN
GO
USE DO_AN

-- Tạo bảng NGUOI_HIEN
CREATE TABLE NGUOI_HIEN (
    ma_nguoi_hien CHAR(6) PRIMARY KEY,
    hoten NVARCHAR(100) NOT NULL,
    cccd CHAR(12) NOT NULL,
    sdt VARCHAR(10) NOT NULL,
    ngay_sinh DATE NOT NULL,
    gioi_tinh NVARCHAR(3) NOT NULL,
    nhom_mau VARCHAR(3) NOT NULL,
    dia_chi NVARCHAR(100)
);

-- Tạo bảng TUI_MAU
CREATE TABLE TUI_MAU (
    ma_mau CHAR(6) PRIMARY KEY,
    hsd DATE NOT NULL,
    tinh_trang BIT NOT NULL,
    the_tich REAL NOT NULL,
    ngay_hien_mau DATE NOT NULL,
    can_nang REAL NOT NULL,
    ngay_nhan_mau DATE,
    ma_nguoi_hien CHAR (6), --Khóa ngoại chỉ đến bảng NGUOI_HIEN
    ma_kho CHAR(6), --Khóa ngoại chỉ đến bảng KHO
    ma_bv CHAR(6), --Khóa ngoại chỉ đến bảng BENH_VIEN
	CONSTRAINT FK_NH_MAU FOREIGN KEY (ma_nguoi_hien) REFERENCES NGUOI_HIEN (ma_nguoi_hien),
	CONSTRAINT FK_KHO_MAU FOREIGN KEY (ma_kho) REFERENCES KHO (ma_kho),
	CONSTRAINT FK_BV_MAU FOREIGN KEY (ma_bv) REFERENCES BENH_VIEN (ma_bv)
);

-- Tạo bảng BENH_VIEN
CREATE TABLE BENH_VIEN (
    ma_bv CHAR(3) PRIMARY KEY,
    ten_bv NVARCHAR(100) NOT NULL,
    dia_chi NVARCHAR(100) NOT NULL,
    sdt VARCHAR(10) NOT NULL
);

-- Tạo bảng NGUOI_NHAN
CREATE TABLE NGUOI_NHAN (
    ma_nguoi_nhan CHAR(6) PRIMARY KEY,
    hoten NVARCHAR(100) NOT NULL,
    cccd CHAR(12) NOT NULL,
    sdt VARCHAR(10) NOT NULL,
    gioi_tinh NVARCHAR(3) NOT NULL,
    nhom_mau VARCHAR(3) NOT NULL,
    dia_chi NVARCHAR(100)
);

-- Tạo bảng NHAN_VIEN
CREATE TABLE NHAN_VIEN (
    ma_nv CHAR(6) PRIMARY KEY,
    hoten NVARCHAR(100) NOT NULL,
    sdt VARCHAR(10) NOT NULL,
    makho_ptr CHAR(6),
    ma_kho CHAR(6) --Khóa ngoại chỉ đến bảng KHO,
    CONSTRAINT FK_KHO_NV 
    FOREIGN KEY (ma_kho) REFERENCES KHO (ma_kho)
);

-- Tạo bảng KHO
CREATE TABLE KHO (
    ma_kho CHAR(6) PRIMARY KEY,
    ten_kho NVARCHAR(100),
);
